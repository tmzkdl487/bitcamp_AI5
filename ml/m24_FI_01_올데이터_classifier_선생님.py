# 06_cancer
# 09_wine
# 11_digits

###  요 파일에 이 3개의 데이터셋 다 넣어서 23번처럼 맹그러.

from sklearn.datasets import load_iris, load_breast_cancer, load_wine, load_digits

from sklearn.preprocessing import MinMaxScaler, StandardScaler, MaxAbsScaler, RobustScaler

from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from xgboost import XGBClassifier

from sklearn.model_selection import train_test_split

from sklearn.metrics import accuracy_score
from sklearn.metrics import mean_squared_error, r2_score

#1. 데이터셋 로드
data_list = [
    load_breast_cancer(return_X_y=True),
    load_wine(return_X_y=True),
    load_digits(return_X_y=True),
]

data_name = ['캔    서', "와    인", "디 지 트"]

#2. 모델 리스트 정의
model_list = [
    DecisionTreeClassifier(),
    RandomForestClassifier(),
    GradientBoostingClassifier(),
    XGBClassifier()
]

for i1, v1 in enumerate(data_list):
    x, y = v1
    x_train, x_test, y_train, y_test = train_test_split(
        x, y, train_size=0.8, shuffle=True, random_state=337, stratify=y,
    )
    scaler = MinMaxScaler()
    x_train = scaler.fit_transform(x_train)
    x_test = scaler.transform(x_test)
    print("########################################################")
    print("#######################" , data_name[i1], "#######################")
    print("########################################################")
    
    for i2, v2 in enumerate(model_list):
        if i2 !=3:
            model = v2
        else:
            model = XGBClassifier()
        #3. 훈련
        model.fit(x_train, y_train)
        
        #4. 평가, 예측
        y_predict = model.predict(x_test)
        acc = accuracy_score(y_test, y_predict)
        print("========", model.__class__.__name__,"==")
        print("accuracy_score : ", acc)
        
        if i2 !=3:
            print(model, ":", model.feature_importances_)
        else:
            print("XGBClassifier() : ", model.feature_importances_)       

# ########################################################
# ####################### 캔    서 #######################
# ########################################################
# ======== DecisionTreeClassifier ==
# accuracy_score :  0.9298245614035088
# DecisionTreeClassifier() : [0.         0.02986407 0.00877122 0.         0.         0.
#  0.03299308 0.         0.         0.0078941  0.         0.
#  0.         0.         0.         0.         0.         0.
#  0.01647517 0.         0.         0.05047439 0.         0.72000218
#  0.         0.         0.         0.12449393 0.         0.00903185]
# ======== RandomForestClassifier ==
# accuracy_score :  0.9649122807017544
# RandomForestClassifier() : [0.03496315 0.01243175 0.01478961 0.05466279 0.00911309 0.01207198
#  0.04323352 0.12044506 0.00241646 0.00425997 0.02368758 0.00433429
#  0.01450344 0.04205039 0.0025091  0.00333227 0.00779474 0.00388575
#  0.00414127 0.00418709 0.09658883 0.01448101 0.13160606 0.10860441
#  0.01419283 0.01259585 0.04147062 0.14413815 0.009793   0.00771593]
# ======== GradientBoostingClassifier ==
# accuracy_score :  0.9824561403508771
# GradientBoostingClassifier() : [1.03718595e-04 2.83150950e-02 1.07388570e-03 1.59042037e-03
#  2.56979306e-03 5.47572110e-04 8.49105366e-03 1.67894441e-01
#  2.30623390e-07 1.73368409e-05 4.90407188e-04 4.28874552e-05
#  5.93664981e-03 5.07282480e-03 1.46251543e-06 1.62586480e-04
#  1.35740025e-03 1.86081010e-03 2.78020513e-03 3.84395436e-05
#  2.10425539e-01 2.98621685e-02 1.20596557e-01 2.67911691e-01
#  1.64995498e-02 1.73635570e-04 2.43305261e-02 1.00337424e-01
#  6.70379984e-06 1.50898573e-03]
# ======== XGBClassifier ==
# accuracy_score :  0.9736842105263158
# XGBClassifier() :  [7.5861458e-03 1.2092577e-02 1.0858712e-02 5.9643001e-03 6.2471195e-03
#  4.8381169e-03 4.9987822e-03 6.2105391e-02 5.8533526e-03 5.2488252e-04
#  6.3719903e-03 5.6953281e-03 2.8461483e-04 8.7473588e-03 7.6683122e-04
#  3.4107177e-03 0.0000000e+00 4.0361706e-02 1.7705266e-03 2.0641186e-03
#  3.9608296e-02 2.5029607e-02 5.8202451e-01 4.5423709e-02 9.3506966e-03
#  0.0000000e+00 2.3723951e-02 8.1794135e-02 2.5024852e-03 0.0000000e+00]

# ########################################################
# ####################### 와    인 #######################
# ########################################################
# ======== DecisionTreeClassifier ==
# accuracy_score :  0.8611111111111112
# DecisionTreeClassifier() : [0.         0.03060147 0.05028449 0.01071051 0.         0.
#  0.16522355 0.         0.         0.32457848 0.         0.
#  0.41860149]
# ======== RandomForestClassifier ==
# accuracy_score :  0.9722222222222222
# RandomForestClassifier() : [0.13422871 0.02717222 0.02007287 0.02509312 0.02147694 0.0674424
#  0.1497551  0.0222473  0.02410745 0.15407968 0.07100383 0.11795911
#  0.16536126]
# ======== GradientBoostingClassifier ==
# accuracy_score :  0.8888888888888888
# GradientBoostingClassifier() : [1.40889541e-03 5.49893164e-02 1.40179765e-02 1.08071603e-03
#  4.47965201e-03 5.18837042e-06 3.02542872e-01 2.05709619e-03
#  2.20854309e-03 2.44757981e-01 5.88476007e-02 1.45671229e-02
#  2.99037040e-01]
# ======== XGBClassifier ==
# accuracy_score :  0.9444444444444444
# XGBClassifier() :  [0.03312182 0.12021569 0.01665129 0.         0.03627352 0.
#  0.24492191 0.0207895  0.01708013 0.20495585 0.06092481 0.01492534
#  0.23014012]

# ########################################################
# ####################### 디 지 트 #######################
# ########################################################
# ======== DecisionTreeClassifier ==
# accuracy_score :  0.8666666666666667
# DecisionTreeClassifier() : [0.         0.00077333 0.00303808 0.00151618 0.00896815 0.0551845
#  0.         0.0010311  0.         0.00128888 0.01320516 0.
#  0.00739384 0.01178126 0.         0.         0.         0.00571783
#  0.01455723 0.02827492 0.05176013 0.0922646  0.00309331 0.
#  0.00153355 0.00147944 0.06540865 0.06255835 0.04598492 0.00550915
#  0.01343557 0.         0.         0.05726792 0.01424278 0.
#  0.07507967 0.0195165  0.01016947 0.         0.         0.01015584
#  0.08269771 0.05892701 0.01948358 0.00443507 0.00575665 0.
#  0.         0.00265141 0.01123997 0.00141777 0.00956582 0.02127596
#  0.0225895  0.         0.         0.0010311  0.0138881  0.
#  0.05611182 0.00154666 0.00519155 0.        ]
# ======== RandomForestClassifier ==
# accuracy_score :  0.9777777777777777
# RandomForestClassifier() : [0.00000000e+00 2.09643274e-03 1.76743387e-02 9.62789045e-03
#  9.98576915e-03 2.36973801e-02 9.85088430e-03 8.20329589e-04
#  1.48810200e-04 1.28478860e-02 2.40834090e-02 7.11096108e-03
#  1.44407017e-02 2.95973267e-02 6.11301675e-03 3.53075246e-04
#  4.32677964e-05 8.19191672e-03 1.94021700e-02 2.50547966e-02
#  3.01076079e-02 5.71335904e-02 1.00904324e-02 3.84179092e-04
#  1.36846980e-05 1.56318165e-02 4.20973414e-02 2.44087723e-02
#  3.35057731e-02 2.42355572e-02 3.07900134e-02 2.65057939e-05
#  0.00000000e+00 2.53862355e-02 2.44330831e-02 2.13498346e-02
#  3.62080593e-02 1.89915642e-02 2.55992380e-02 0.00000000e+00
#  6.24794913e-05 1.10135431e-02 3.77609919e-02 4.02628326e-02
#  2.48972513e-02 1.84913907e-02 1.85076513e-02 5.29756884e-05
#  2.22969703e-05 2.03839928e-03 1.45649485e-02 2.21422500e-02
#  1.24032478e-02 2.43314653e-02 2.56658275e-02 1.71566763e-03
#  0.00000000e+00 1.89965384e-03 2.39512438e-02 9.53819001e-03
#  2.36521259e-02 2.49884337e-02 1.81482311e-02 2.35525109e-03]
# ======== GradientBoostingClassifier ==
# accuracy_score :  0.9555555555555556
# GradientBoostingClassifier() : [0.00000000e+00 1.55195696e-03 8.09955628e-03 3.86449471e-03
#  1.50335426e-03 6.49831135e-02 5.94496126e-03 1.99730942e-03
#  2.89344791e-04 2.69702227e-03 1.50538006e-02 2.31194669e-03
#  4.19555181e-03 1.02796282e-02 4.37670608e-03 2.70888147e-04
#  4.44477869e-04 4.33331554e-03 8.94075271e-03 4.40669341e-02
#  2.47166121e-02 9.08701935e-02 3.25011447e-03 0.00000000e+00
#  2.33096112e-05 1.14265644e-03 5.20836815e-02 1.39460806e-02
#  3.16448531e-02 2.24427808e-02 4.51835582e-03 0.00000000e+00
#  0.00000000e+00 6.70208699e-02 2.86978459e-03 9.60212216e-03
#  7.13946232e-02 8.19889456e-03 1.63082323e-02 0.00000000e+00
#  0.00000000e+00 4.28925225e-03 8.15621338e-02 7.06034616e-02
#  1.17936359e-02 2.69207422e-02 2.00638816e-02 9.84663275e-05
#  5.16581722e-11 9.10704032e-04 6.76883377e-03 1.95505999e-02
#  7.51207991e-03 1.39669279e-02 2.56992737e-02 5.05956461e-04
#  5.73413753e-04 1.40325778e-04 1.14379954e-02 3.18913300e-03
#  4.81209117e-02 1.08130956e-02 2.18606863e-02 8.38020924e-03]
# ======== XGBClassifier ==
# accuracy_score :  0.9555555555555556
# XGBClassifier() :  [0.         0.07077969 0.00528341 0.00548552 0.00315305 0.02984
#  0.00532804 0.00295083 0.         0.00717625 0.00626246 0.00390767
#  0.00526441 0.00604744 0.01409641 0.00623554 0.         0.00633316
#  0.0057681  0.03744382 0.00733271 0.03365225 0.00378969 0.
#  0.         0.00554582 0.02468202 0.00537317 0.02379439 0.01845083
#  0.0093237  0.         0.         0.05057533 0.00130538 0.00858804
#  0.03329038 0.00703605 0.0245399  0.         0.         0.00587606
#  0.02580388 0.02670399 0.00857507 0.01445603 0.01942207 0.
#  0.         0.00331757 0.00392144 0.00451918 0.00716421 0.01271279
#  0.01950661 0.24611157 0.         0.00998598 0.00848023 0.01055412
#  0.04848262 0.00831158 0.02396589 0.01349365]